<!DOCTYPE HTML>
<!--
	MedCityAI - Real-time research analytics
-->
<html>
	<head>
		<title>Med City AI</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="landing is-preload">

			<script>
			// Global variables
			var VarTot = 0, VarDay = 0, VarWeek = 0, VarMonth = 0;

			// Fetch and process summary_stats.txt from ./database/summary_stats.txt
			async function fetchAndRecordVars() {
				const statsPath = './database/summary_stats.txt';
				try {
					const response = await fetch(statsPath);
					if (!response.ok) throw new Error('summary_stats.txt not found');
					const statsText = await response.text();
					// Parse lines like VarTot=1500
					statsText.split('\n').forEach(line => {
						const [key, value] = line.split('=');
						if (key && value) {
							if (key.trim() === 'VarTot') VarTot = parseInt(value.trim());
							if (key.trim() === 'VarDay') VarDay = parseInt(value.trim());
							if (key.trim() === 'VarWeek') VarWeek = parseInt(value.trim());
							if (key.trim() === 'VarMonth') VarMonth = parseInt(value.trim());
						}
					});
				} catch (err) {
					console.error('Error loading summary_stats.txt:', err);
				}
			}

			// Call at start
			fetchAndRecordVars().then(() => {
				const bannerSpan = document.getElementById("VarTot");
				const bannerDay = document.getElementById("VarDay");
				const bannerWeek = document.getElementById("VarWeek");
				const bannerMonth = document.getElementById("VarMonth");
				if (bannerSpan) bannerSpan.textContent = VarTot;
				if (bannerDay) bannerDay.textContent = VarDay;
				if (bannerWeek) bannerWeek.textContent = VarWeek;
				if (bannerMonth) bannerMonth.textContent = VarMonth;
			});
			</script>
			<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<h1><a href="index.html">Med City AI</a></h1>
						<nav id="nav">
							<ul>
								<li class="special">
									<a href="#menu" class="menuToggle"><span>Menu</span></a>
									<div id="menu">
										<ul>
											<li><a href="index.html">Home</a></li>
											<li><a href="generic.html">Generic</a></li>
											<li><a href="elements.html">Elements</a></li>
											<li><a href="#">Sign Up</a></li>
											<li><a href="#">Log In</a></li>
										</ul>
									</div>
								</li>
							</ul>
						</nav>
					</header>
				<!-- here is where I'd like to open one folder up database/pubmed_results.csv and then export three variables VarTot (number of total entries) VarDay (number of entries in past 24 hours) VarWeek (number of entries in past 7 days) VarMonth (number of entries in past 30 days) and then have those variables populate the following sections below% -->
				<!-- Banner -->
					<section id="banner">
						<div class="inner">
							<h2>Med City AI</h2>
							<p>Real-time research analytics<br />
							from beneath the corntower</p>
						    <div style="display: flex; justify-content: space-around; text-align: center; margin-top: 2em;">
						</div>
						<a href="#one" class="more scrolly"> Papers Indexed:  <span id="VarTot"></span> </a> <!-- replace 16000 with VarTot -->

					</section>
				
				<!-- One -->
					<section id="one" class="wrapper style1 special">
						<div class="inner">
							<header class="major">
								<h2>Recently Published in Rochester, MN:</h2>
							</header>

						
						    <!-- Numbers Section -->
						    <div style="display: flex; justify-content: space-around; text-align: center; margin-top: 2em;">
						      <div class="stat-item">
						        <!-- <h2 class="count" id="VarDay" data-target="0">0</h2> -->
						        <h2 id="VarDay">0</h2> <!-- dynamically replaced by JS -->								<p>new today</p>
						      </div>
						      <div class="stat-item">
						        <!-- <h2 class="count" id="VarWeek" data-target="0">0</h2> replace 100 with VarWeek -->
						        <h2 id="VarWeek">0</h2> <!-- dynamically replaced by JS -->						        
								<p>new this week</p>
						      </div>
						      <div class="stat-item">
						        <h2 id="VarMonth">0</h2> <!-- replace 10000 with VarMonth -->
						        <p>new this month</p>
						      </div>
						    </div>
						  </div>

						<div class="scroll-container">
						<div class="scroll-content">
							<img src="./database/featured/img1.jpg" alt="1">
							<img src="./database/featured/img2.jpg" alt="2">
							<img src="./database/featured/img3.jpg" alt="3">
							<img src="./database/featured/img4.jpg" alt="4">
							<img src="./database/featured/img5.jpg" alt="5">
							<img src="./database/featured/img6.jpg" alt="6">
							<img src="./database/featured/img7.jpg" alt="7">
							<img src="./database/featured/img8.jpg" alt="8">

							<!-- Duplicate for looping effect -->
							<img src="./database/featured/img1.jpg" alt="1">
							<img src="./database/featured/img2.jpg" alt="2">
							<img src="./database/featured/img3.jpg" alt="3">
							<img src="./database/featured/img4.jpg" alt="4">
							<img src="./database/featured/img5.jpg" alt="5">
							<img src="./database/featured/img6.jpg" alt="6">
							<img src="./database/featured/img7.jpg" alt="7">
							<img src="./database/featured/img8.jpg" alt="8">
						</div>
						</div>
						
						<!-- Dropdown + Results Container -->
						<div class="pubmed-container">
						<label for="pubmed-query">Filter by Topic:</label>
						<select id="pubmed-query" onchange="fetchPubMedResults()">
							<option value="everything" selected>Everything</option>
							<option value="genai">Generative AI</option>
							<option value="deeplearning">Deep Learning</option>
							<option value="informatics">Informatics</option>
							<option value="radiology">Radiology</option>
						</select>

						<!-- Results will render here -->
						<div id="pubmed-results" style="margin-top:20px; text-align:left;"></div>
						</div>

						<style>
						/* Add margin on left/right */
						.pubmed-container {
						margin: 0 auto;           /* center horizontally */
						padding: 0 20px;          /* left & right padding */
						max-width: 800px;         /* optional: prevent overly wide text */
						}

						/* Style dropdown a little */
						.pubmed-container select {
						padding: 6px 10px;
						border-radius: 6px;
						border: 1px solid #ccc;
						margin-bottom: 15px;
						}
						</style>



						<style>
						.scroll-container {
						width: 100%;
						overflow: hidden;
						}

						.scroll-content {
						display: flex;
						animation: scroll 5s linear infinite;
						}

						.scroll-content img {
						height: 250px;
						margin-right: 20px;
						margin-bottom: 80px;
						flex-shrink: 0;
						border-radius: 12px;
						object-fit: cover;
						}

						/* Scroll Animation */
						@keyframes scroll {
						0% { transform: translateX(0); }
						100% { transform: translateX(-50%); }
						}
						</style>
						
						<script>
						async function fetchPubMedResults() {
						const queryType = document.getElementById("pubmed-query").value;
						
						// Define queries
						const queries = {
							everything: `("Mayo"[AD] AND ("Minnesota"[AD] OR "MN"[AD]))`,
							genai: `(("Generative AI" OR "Large language model" OR "chatgpt") AND "Mayo"[AD] AND ("Minnesota"[AD] OR "MN"[AD]))`,
							deeplearning: `(("Deep learning" OR "Neural network") AND "Mayo"[AD] AND ("Minnesota"[AD] OR "MN"[AD]))`,
							informatics: `("informatics" AND "Mayo"[AD] AND ("Minnesota"[AD] OR "MN"[AD]))`,
							radiology: `(("CT" OR "MRI" OR "ultrasound" OR "radiology") AND "Mayo"[AD] AND ("Minnesota"[AD] OR "MN"[AD]))`
						};

						const term = queries[queryType];
						const esearchUrl = `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term=${encodeURIComponent(term)}&retmax=10&sort=pub+date&retmode=json`;

						try {
							const esearchRes = await fetch(esearchUrl);
							const esearchData = await esearchRes.json();
							const ids = esearchData.esearchresult.idlist;

							if (ids.length === 0) {
							document.getElementById("pubmed-results").innerHTML = "<p>No results found.</p>";
							return;
							}

							// Fetch summaries
							const esummaryUrl = `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=${ids.join(",")}&retmode=json`;
							const esummaryRes = await fetch(esummaryUrl);
							const esummaryData = await esummaryRes.json();

							// Build results HTML
							let resultsHTML = "<ul>";
							ids.forEach(id => {
							const article = esummaryData.result[id];
							if (article) {
								const title = article.title || "No title";
								const authors = article.authors?.length ? `${article.authors[0].name} et al.` : "Unknown";
								const journal = article.fulljournalname || "Unknown Journal";
								const pubdate = article.epubdate || article.pubdate || "No date";

								resultsHTML += `<li>
								<strong>${title}</strong><br>
								${authors} <em>${journal}</em>. ${pubdate}
								</li>`;
							}
							});
							resultsHTML += "</ul>";

							document.getElementById("pubmed-results").innerHTML = resultsHTML;
						} catch (error) {
							console.error(error);
							document.getElementById("pubmed-results").innerHTML = "<p>Error fetching results.</p>";
						}
						}

						// Fetch default ("everything") on page load
						document.addEventListener("DOMContentLoaded", fetchPubMedResults);
						</script>
						<!--
						<script>
						  // Animate counters when visible
						  const counters = document.querySelectorAll('.count');
						  const speed = 1500; // animation duration in ms
						
						  const animateCounter = (counter) => {
						    const target = +counter.getAttribute('data-target');
						    let start = 0;
						    const increment = target / (speed / 16); // approx 60fps
						
						    const update = () => {
						      start += increment;
						      if (start < target) {
						        counter.textContent = Math.ceil(start);
						        requestAnimationFrame(update);
						      } else {
						        counter.textContent = target;
						      }
						    };
						    update();
						  };
						  
						  const observer = new IntersectionObserver((entries) => {
						    entries.forEach(entry => {
						      if (entry.isIntersecting) {
						        animateCounter(entry.target);
						        observer.unobserve(entry.target);
						      }
						    });
						  }, { threshold: 0.5 });
						
						  counters.forEach(counter => observer.observe(counter));
						</script>
						-->
				
				<!-- Two -->
					<section id="two" class="wrapper alt style2">
						<section class="spotlight">
							<div class="image"><img src="images/pub_plot.jpg" alt="" /></div><div class="content">
								<h2>Rochester Publications by Year</h2>
								<p>The publication rate fits an exponential growth model with a doubling rate of 10.2 years. The peak publication year was 2021 with 10,510.</p>
							</div>
						</section>
						<section class="spotlight">
						<div class="image">
							<iframe src="state_map.html" width="100%" height=400px style="border:none;"></iframe>
						</div>
						<div class="content">
							<h2>Co-author Affiliations By State (2025)</h2>
							<p>This interactive choropleth map shows the geographic distribution of co-author affiliations across the United States.</p>
						</div>
						</section>
						<section class="spotlight">
							<div class="image">
							<iframe src="world_map.html" width="100%" height=400px style="border:none;"></iframe>
						</div>
						<div class="content">
							<h2>Co-author Affiliations By Country (2025)</h2>
							<p>This interactive choropleth map shows the geographic distribution of co-author affiliations across the world.</p>
						</div>
						</section>
					</section>

				<!-- Three -->
					<section id="three" class="wrapper style3 special">
						<div class="inner">
							<header class="major">
								<h2>Accumsan mus tortor nunc aliquet</h2>
								<p>Aliquam ut ex ut augue consectetur interdum. Donec amet imperdiet eleifend<br />
								fringilla tincidunt. Nullam dui leo Aenean mi ligula, rhoncus ullamcorper.</p>
							</header>
							<ul class="features">
								<li class="icon fa-paper-plane">
									<h3>Arcu accumsan</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
								<li class="icon solid fa-laptop">
									<h3>Ac Augue Eget</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
								<li class="icon solid fa-code">
									<h3>Mus Scelerisque</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
								<li class="icon solid fa-headphones-alt">
									<h3>Mauris Imperdiet</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
								<li class="icon fa-heart">
									<h3>Aenean Primis</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
								<li class="icon fa-flag">
									<h3>Tortor Ut</h3>
									<p>Augue consectetur sed interdum imperdiet et ipsum. Mauris lorem tincidunt nullam amet leo Aenean ligula consequat consequat.</p>
								</li>
							</ul>
						</div>
					</section>

				<!-- CTA -->
					<section id="cta" class="wrapper style4">
						<div class="inner">
							<header>
								<h2>Arcue ut vel commodo</h2>
								<p>Aliquam ut ex ut augue consectetur interdum endrerit imperdiet amet eleifend fringilla.</p>
							</header>
							<ul class="actions stacked">
								<li><a href="#" class="button fit primary">Activate</a></li>
								<li><a href="#" class="button fit">Learn More</a></li>
							</ul>
						</div>
					</section>

				<!-- Footer -->
					<footer id="footer">
						<ul class="icons">
							<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
							<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
							<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
						</ul>
						<ul class="copyright">
							<li>&copy; Untitled</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>

</html>


























